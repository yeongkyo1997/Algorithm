# [Platinum I] 녜힁 - 17373 

[문제 링크](https://www.acmicpc.net/problem/17373) 

### 성능 요약

메모리: 318216 KB, 시간: 500 ms

### 분류

이분 탐색(binary_search), 자료 구조(data_structures), 오프라인 쿼리(offline_queries), 퍼시스턴트 세그먼트 트리(pst), 세그먼트 트리(segtree)

### 문제 설명

<p>해조는 2019년 8월 3일에 오픈베타가 열리는 대작 MMORPG '패스 오브 여로'에서 사전예약을 하려고 한다. 해조는 예쁜 두 글자 닉네임을 갖고 싶었지만 발 빠른 다른 유저들이 선점하여 가질 수 없었다.</p>

<p>해조가 선점된 닉네임의 규칙을 살펴본 결과 특정 소설에서 순서대로 두 글자를 따온 닉네임들은 전부 등록되어 있었고 그 외의 두 글자 닉네임은 모두 만들 수 있었다. 예를 들어 소설의 내용이 '나랏말싸미듕귁에달아'이라고 해보자. 해조가 발견한 규칙에 따르면 '나미'는 이미 있는 닉네임이고, '아싸'는 언급된 글에서 '아'보다 '싸'가 앞에 있어서 소설에서 만들 수 없는 단어이므로 생성할 수 있는 닉네임이다.</p>

<p>해조는 만들 수 있는 두 글자 닉네임 중에서 사전 순으로 <em>K</em>번째로 앞서는 것을 닉네임으로 정하려고 한다. 해조는 <em>Q</em>개의 <em>K</em>를 정하여 닉네임을 구한 다음 그중에서 가장 예쁜 것을 선택할 예정이다. 해조를 도와 소설의 내용이 주어졌을 때 만들 수 있는 닉네임 중에서 사전 순으로 <em>K</em>번째로 앞선 것을 구하는 프로그램을 작성하여라.</p>

<p>편의상 모든 글자는 1 이상 <em>M</em> 이하의 정수로 표현하며, 닉네임 <em>AB</em>가 닉네임 <em>CD</em>보다 사전 순으로 앞선다는 것은 <em>A</em> < <em>C</em>이거나, <em>A</em> = <em>C</em>이고 <em>B</em> < <em>D</em>임을 의미한다.</p>

### 입력 

 <p>첫 번째 줄에는 소설의 길이 <em>N</em>(1 ≤ <em>N</em> ≤ 100,000), 글자의 종류 수 <em>M</em>(1 ≤ <em>M</em> ≤ 1,000,000), 쿼리의 수 <em>Q</em>(1 ≤ <em>Q</em> ≤ 100,000)가 주어진다.</p>

<p>두 번째 줄에는 소설의 내용에 해당하는 <em>N</em>개의 1 이상 <em>M</em> 이하의 정수가 주어진다.</p>

<p>세 번째 줄부터 <em>Q</em>개의 줄에는 가지려는 닉네임의 사전 순 번호 <em>K</em>(1 ≤ <em>K</em> ≤ <em>M</em><sup>2</sup>)가 주어진다.</p>

### 출력 

 <p><em>Q</em>개의 줄에 걸쳐 만들 수 있는 두 글자 닉네임 중 사전 순으로 <em>K</em>번째로 앞선 것을 출력한다. 앞글자와 뒷글자 사이는 공백으로 구분한다.</p>

<p>만약 만들 수 있는 닉네임의 개수가 <em>K</em>개보다 적다면 <code>-1 -1</code>을 출력한다.</p>

<p>앞선 쿼리는 이후의 쿼리에 영향을 주지 않는다.</p>

